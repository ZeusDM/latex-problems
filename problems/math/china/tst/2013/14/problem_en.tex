The circumcircle of triangle $ABC$ has centre $O$. $P$ is the midpoint of $\widehat{BAC}$ and $QP$ is the diameter. Let $I$ be the incentre of $\triangle ABC$ and let $D$ be the intersection of $PI$ and $BC$. The circumcircle of $\triangle AID$ and the extension of $PA$ meet at $F$. The point $E$ lies on the line segment $PD$ such that $DE=DQ$. Let $R,r$ be the radius of the inscribed circle and circumcircle of $\triangle ABC$,  respectively.

Show that if $\angle AEF=\angle APE$,  then $\sin^2\angle BAC=\dfrac{2r}R$