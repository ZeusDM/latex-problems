For all $n\ge 1$, let $a_n=\sum_{k=1}^{n-1}\frac{\sin(\frac{(2k-1)\pi}{2n})}{\cos^2(\frac{(k-1)\pi}{2n})\cos^2(\frac{k\pi}{2n})}$. Determine $\lim_{n\rightarrow \infty}\frac{a_n}{n^3}$.