Let $n$ be a positive integer. A frog starts on the number line at $0$. Suppose it makes a finite sequence of hops, subject to two conditions:
\begin{itemize}
	\item The frog visits only points in $\left\{1,2,\ldots,2^n-1\right\}$, each at most once.
	\item The length of each hop is in $\left\{2^0,2^1,2^2,\ldots\right\}$. (The hops may be either direction, left or right.)
\end{itemize}
Let $S$ be the sum of the (positive) lengths of all hops in the sequence. What is the maximum possible value of $S$?