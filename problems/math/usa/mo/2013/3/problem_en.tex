Let $n$ be a positive integer.  There are $\tfrac{n(n+1)}{2}$ marks, each with a black side and a white side, arranged into an equilateral triangle, with the biggest row containing $n$ marks.  Initially, each mark has the black side up.  An operation is to choose a line parallel to the sides of the triangle, and flipping all the marks on that line.  A configuration is called admissible  if it can be obtained from the initial configuration by performing a finite number of operations.  For each admissible configuration $C$,  let $f(C)$ denote the smallest number of operations required to obtain $C$ from the initial configuration.  Find the maximum value of $f(C)$,  where $C$ varies over all admissible configurations.