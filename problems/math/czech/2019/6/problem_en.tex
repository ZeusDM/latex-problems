Assume we can fill a table $n\times n$ with all numbers $1,2,\ldots,n^2-1,n^2$ in such way that arithmetic means of numbers in every row and every column is an integer. Determine all such positive integers $n$.