Let $S$ be the value of
\[\sum_{n=1}^\infty \frac{d(n) + \sum_{m=1}^{\nu_2(n)}(m-3)d\left(\frac{n}{2^m}\right)}{n},\]
where $d(n)$ is the number of divisors of $n$ and $\nu_2(n)$ is the exponent of $2$ in the prime factorization of $n$. If $S$ can be expressed as $(\ln m)^n$ for positive integers $m$ and $n$, find $1000n + m$.
