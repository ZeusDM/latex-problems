Let $p = 2^{16}+1$ be a prime, and let $S$ be the set of positive integers not divisible by $p$.
Let $f: S \to \{0, 1, 2, \ldots, p-1\}$ be a function satisfying
\[ f(x)f(y) \equiv f(xy)+f(xy^{p-2}) \pmod{p} \quad\text{and}\quad f(x+p) = f(x) \]
for all $x,y \in S$.
Let $N$ be the product of all possible nonzero values of $f(81)$.
Find the remainder when when $N$ is divided by $p$.
