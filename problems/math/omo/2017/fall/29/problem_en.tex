Let $p = 2017$. If $A$ is an $n\times n$ matrix composed of residues $\pmod{p}$ such that $\det A\not\equiv 0\pmod{p}$ then let $\text{ord}(A)$ be the minimum integer $d > 0$ such that $A^d\equiv I\pmod{p}$, where $I$ is the $n\times n$ identity matrix. Let the maximum such order be $a_n$ for every positive integer $n$. Compute the sum of the digits when $\sum_{k = 1}^{p + 1} a_k$ is expressed in base $p$.
