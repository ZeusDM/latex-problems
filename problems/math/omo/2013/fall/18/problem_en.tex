Given an $n\times n$ grid of dots, let $f(n)$ be the largest number of segments between adjacent dots which can be drawn such that (i) at most one segment is drawn between each pair of dots, and (ii) each dot has $1$ or $3$ segments coming from it.  (For example, $f(4)=16$.) Compute $f(2000)$.
