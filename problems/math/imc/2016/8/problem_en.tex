Let $n$ be a positive integer, and denote by $\mathbb{Z}_n$ the ring of integers modulo $n$. Suppose that there exists a function $f:\mathbb{Z}_n\to\mathbb{Z}_n$ satisfying the following three properties:

(i) $f(x)\neq x$,

(ii) $f(f(x))=x$,

(iii) $f(f(f(x+1)+1)+1)=x$ for all $x\in\mathbb{Z}_n$.

Prove that $n\equiv 2 \pmod4$.

(Proposed by Ander Lamaison Vidarte, Berlin Mathematical School, Germany)