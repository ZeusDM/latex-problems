Let $S$ be the set of positive real numbers. Find all functions $f\colon S^3 \to S$ such that, for all positive real numbers $x$,  $y$,  $z$ and $k$,  the following three conditions are satisfied:

(a) $xf(x,y,z) = zf(z,y,x)$, 

(b) $f(x, ky, k^2z) = kf(x,y,z)$, 

(c) $f(1, k, k+1) = k+1$.

(United Kingdom)