Let $n \geq 2$ be an integer. Let $S$ be a subset of $\{1,2,\dots,n\}$ such that $S$ neither contains two elements one of which divides the other, nor contains two elements which are coprime. What is the maximal possible number of elements of such a set $S$?