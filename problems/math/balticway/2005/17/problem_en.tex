A sequence $(x_n)_{n\ge 0}$ is defined as follows: $x_0=a,x_1=2$ and $x_n=2x_{n-1}x_{n-2}-x_{n-1}-x_{n-2}+1$ for all $n>1$. Find all integers $a$ such that $2x_{3n}-1$ is a perfect square for all $n\ge 1$.