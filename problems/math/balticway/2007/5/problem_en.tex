A function $f$ is defined on the set of all real numbers except $0$ and takes all real values except $1$. It is also known that$\color{white}\ . \ \color{black}\ \quad f(xy)=f(x)f(-y)-f(x)+f(y)$

for any $x,y\not= 0$ and that$\color{white}\ . \ \color{black}\ \quad f(f(x))=\frac{1}{f(\frac{1}{x})}$

for any $x\not\in\{ 0,1\}$. Determine all such functions $f$.