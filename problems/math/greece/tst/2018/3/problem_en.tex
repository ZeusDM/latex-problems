Find all functions $f:\mathbb{Z}_{>0}\mapsto\mathbb{Z}_{>0}$ such that

$$xf(x)+(f(y))^2+2xf(y)$$is perfect square for all positive integers $x,y$.

**This problem was proposed by me for the BMO 2017 and it was shortlisted. We then used it in our TST.