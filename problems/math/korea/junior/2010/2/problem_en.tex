Let there be a $n\times n$ board. Write down $0$ or $1$ in all $n^2$ squares. For $1 \le k \le n$, let $A_k$ be the product of all numbers in the $k$th row. How many ways are there to write down the numbers so that $A_1 + A_2 + ... + A_n$ is even?